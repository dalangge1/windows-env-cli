#!/usr/bin/env node
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const cli_1=require("./cli"),reg_1=require("./reg"),cli=new cli_1.default,regMgr=new reg_1.RegMgr;async function list(a){const b=await regMgr.list(a);if(1===b.length){const a=b[0];a.values.length?console.log(`key: ${a.key}
type: ${a.type}
values:
${a.values.map((a,b)=>`[${b}] ${a}\n`).join("")}`):console.log(`key: ${a.key}
type: ${a.type}
value: ${a.value}`)}else b.forEach((a,b)=>{console.log(`[${b}] ${a.key}: ${a.value}`)})}async function success(){console.log("\u64CD\u4F5C\u6210\u529F")}async function edit({key:a,operator:b,value:c,index:d=-1}){switch(b){case"set":return await regMgr.set(a,c).then(success);case"remove":return await regMgr.remove(a,c?~~c:void 0).then(success);case"push":return await regMgr.push(a,c).then(success);case"unshift":return await regMgr.unshift(a,c).then(success);case"replace":return await regMgr.replace(a,d,c).then(success);}console.log("operator\u672A\u8BC6\u522B")}const isWindows=!!~(process.env.OS||"").toLowerCase().indexOf("windows");isWindows?cli.action("-h --help","\u663E\u793A\u5E2E\u52A9","",()=>cli.help()).action("-l --list [?key]","\u5217\u51FA\u73AF\u5883\u53D8\u91CF","",async({key:a})=>await list(a)).action("-e --edit [key] [operator] [value]","\u7F16\u8F91\u73AF\u5883\u53D8\u91CFpath\u8DEF\u5F84","",edit).action("-lp --list-path","= -l Path","Alias",async()=>await list("Path")).action("-a --add-path [value]","= -e Path push [value]","Alias",({value:a})=>edit({key:"Path",operator:"push",value:a})).action("-p --push [key] [value]","= -e [key] push [value]","Alias",({key:a,value:b})=>edit({key:a,operator:"push",value:b})).action("-s --set [key] [value]","= -e [key] set [value]","Alias",({key:a,value:b})=>edit({key:a,operator:"set",value:b})).action("-us --unshift [key] [value]","= -e [key] unshift [value]","Alias",({key:a,value:b})=>edit({key:a,operator:"unshift",value:b})).action("-r --remove [key] [?index]","= -e [key] remove [?index]","Alias",({key:a,index:b})=>edit({key:a,operator:"remove",value:b})).action("-rp --replace [key] [?index] [value]","= -e [key] replace [?index] [value]","Alias",({key:a,index:b,value:c})=>edit({key:a,operator:"replace",value:c,index:~~b})).action("env-mgr -e Path push 'D:\\DEV\\Android'","// path\u589E\u52A0\u8DEF\u5F84","Examples").action("env-mgr -e DEPOT_TOOLS_WIN_TOOLCHAIN set 0","// \u8BBE\u7F6E\u503C","Examples").run(process.argv.slice(2)):console.log("\u4EC5\u4EC5\u652F\u6301windows\u4E0A\u4F7F\u7528");